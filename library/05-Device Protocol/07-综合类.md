## 综合类设备协议

>综合类设备，主要包括一键调光、四路输入转换器、二路输出转换器、一路有线无线翻译器、Mini网关（Mini网关虚拟设备）、一键调光开关、二键调光开关、一键开关、二键开关、三键开关、四键开关


### 一键调光 Type--14
一键调光，复合设备，

主设备类型DevicType=14

{

端口1 epType=12（调光），

端口2 epType=30（场景）

}。

1）返回数据协议

EP_ONE（调光）的返回数据由2位十六进制数表示亮度值，范围0x00~0xFF。

2）发送数据协议

EP_ONE（调光）的发送数据由3位十进制数表示亮度值，范围000~255；

EP_TWO（场景）是绑定的场景ID，共2钟命令，51：获取，52：设置。

### 中继器 Type--31
中继器,设备类型DeviceType=31。

1）返回数据协议

无

2）发送数据协议

无

### 二键场景开关 Type--32
二键场景开关,设备类型DeviceType=32。

1）返回数据协议

无

2）发送数据协议

绑定类设备,不可控

### 三键场景开关 Type--33
三键场景开关,设备类型DeviceType=33。

1）返回数据协议

无

2）发送数据协议

绑定类设备,不可控

### 四键场景开关 Type--34
四键场景开关,设备类型DeviceType=34。

1）返回数据协议

无

2）发送数据协议

绑定类设备,不可控

### 密码键盘 （停产） Type--35
密码键盘,设备类型DeviceType=35。

1）返回数据协议

无

2）发送数据协议

绑定类设备,不可控

### 六键场景开关 Type--36
六键场景开关,设备类型DeviceType=36。

1）返回数据协议

无

2）发送数据协议

绑定类设备,不可控

### 六键场景开关--02型 Type--37
六键场景开关--02型,设备类型DeviceType=37。

1）返回数据协议

无

2）发送数据协议

绑定类设备,不可控

### 小型遥控器 Type--38
小型遥控器,设备类型DeviceType=38。

1）返回数据协议

无

2）发送数据协议

绑定类设备,不可控

### 一路绑定开关 Type--52
一路绑定开关,设备类型DeviceType=52。

1）返回数据协议

无

2）发送数据协议

绑定类设备,不可控

### 二路绑定开关 Type--54
二路绑定开关,设备类型DeviceType=54。

1）返回数据协议

无

2）发送数据协议

绑定类设备,不可控

### 一路绑定开关 Type--52
三路绑定开关,设备类型DeviceType=55。

1）返回数据协议

无

2）发送数据协议

绑定类设备,不可控

### 四路绑定开关 Type--56
四路绑定开关,设备类型DeviceType=56。

1）返回数据协议

无

2）发送数据协议

绑定类设备,不可控

### 四路输入转换器 Type--A1
四路输入转换器，复合设备，

主设备类型DevicType=A1

{

端口1 epType=A1（输入），

端口2 epType=A1（输入），

端口3 epType=A1（输入），

端口4 epType=A1（输入）

}。

1）返回数据协议

返回数据由4位数表示信号或状态的标识，共3种数据格式，包括010A、020B、030C。

根据不同数据类别，具体数据意义如下：

010A：01表示设置信号输入标识；

0A表示输入方式（00为闭路输入，01为开路输入）。

020B：02表示查询信号输入标识；

0B表示输入方式（00为闭路输入，01为开路输入）。

030C：03表示报警状态表示；

0C表示报警状态（00为报警，01为消警）。

2）发送数据协议

控制模式：共两种命令用来设置信号输入方式，

1MNJK：四路分别设置；

M、N、J、K分别对应四路，0表示闭路输入，1表示开路输入。

2：查询信号输入方式。

设置模式：共两种命令，0：撤防；1：布防。

3）示例

设置公共端与对应端口（1,2,3,4）为闭路输入，公共端与对应端口（1,2,3,4）如果与设置相同则显示正常，如果外部与设置不同则显示报警。

A）输入控制：

软件设置闭路输入，外部COM公共端引线和1路断开则设备当前状态显示报警，连接则显示正常。

软件设置开路输入，外部COM公共端引线和1路断开则设备当前状态显示正常，连接则显示报警。

软件设置查询输入方式，即把当前设备的输入状态以及设备当前的报警状态上报给网关

设备当前状态，即在设防状态下，如果当前设备的实际外部COM公共端引线和1路的断开或者连接状态与设置的输入控制方式相同，则显示正常，如果不相同则显示报警。在撤防状态下，则一直显示正常。

### 二路输出转换器 Type--A2
二路输出转换器，设备类型DeviceType=A2。

1）返回数据协议

返回数据由不定长数表示设备状态或输出方式，共4种数据格式，包括010N0M、020N0M、030NTT0MTT、040NTT0MTT。

根据不同数据类别，具体数据意义如下：

010N0M：01表示设置断电重启后设备的默认输出方式；

N表示第一路输出标志，0：开路；1：闭路；

M表示第二路输出标志，0：开路；1：闭路。

020N0M：02表示读取断电重启后设备的默认输出方式；

N表示第一路输出标志，0：开路；1：闭路；

M表示第二路输出标志，0：开路；1：闭路。

030NTT0MTT：03表示状态上报；

0N表示第一路告警输出状态，00：开路；01：闭路；03：开路延时；04：闭		路延时；

0M表示第二路告警输出状态，00：开路；01：闭路；03：开路延时；04：闭		路延时；

TT表示时间参数，当N、M为0、1时，TT为00，表示状态一直保持。当N、		M为0、1时，TT为01~99，表示有效操作时间。

040NTT0MTT：04表示读取当前设备的输出方式；

0N表示第一路告警输出状态，00：开路；01：闭路；03：开路延时；04：闭		路延时；

0M表示第二路告警输出状态，00：开路；01：闭路；03：开路延时；04：闭		路延时；

TT表示时间参数，当N、M为0、1时，TT为00，表示状态一直保持。当N、		M为0、1时，TT为01~99，表示有效操作时间。

2）发送数据协议

控制模式：共四种命令用来设置输出方式，包括1NM、21、3NTTMTT、41。

根据不同数据类别，具体数据意义如下：

1NM：1表示设置默认输出方式；

N表示第一路输出标志，0：开路；1：闭路；

M表示第二路输出标志，0：开路；1：闭路；

21：表示读取默认输出方式；

3NTTMTT：3表示设置报警输出；

N表示第一路输出标志，0：开路；1：闭路；2：不改变状态；3：开路延		时；4：闭路延时；

M表示第二路输出标志，0：开路；1：闭路；2：不改变状态；3：开路		延时；4：闭路延时；

TT表示时间参数，当N、M为0或者1时，TT为00（表示状态一直保持），		当N、M为3或者4时，TT为01~99（表示有效操作时间，单位为秒）；

41：表示读取当前设备的输出方式。

设置模式：无。

3）示例

设置公共端与对应端口（1,2,3,4）为闭路输入，公共端与对应端口（1,2,3,4）如果与设置相同则显示正常，如果外部与设置不同则显示报警。

A）输入控制：

软件设置闭路输入，外部COM公共端引线和1路断开则设备当前状态显示报警，连接则显示正常。

软件设置开路输入，外部COM公共端引线和1路断开则设备当前状态显示正常，连接则显示报警。

软件设置查询输入方式，即把当前设备的输入状态以及设备当前的报警状态上报给网关

设备当前状态，即在设防状态下，如果当前设备的实际外部COM公共端引线和1路的断开或者连接状态与设置的输入控制方式相同，则显示正常，如果不相同则显示报警。在撤防状态下，则一直显示正常。

B）输出控制：

将万用表调到蜂鸣器档，红表笔和黑表笔分别接Out两个端口。

开路输出，蜂鸣器一直不响；

闭路输出，蜂鸣器一直响；

开路延时，蜂鸣器不响后切换为响（切换时间为0-99s，时间可以设置）；

闭路延时，蜂鸣器响后切换一直不响（切换时间为0-99s，时间可以设置）。

注：切换状态时指示灯会闪2下绿灯。

C）输出方式设置：

软件设置开路输出，则默认输出方式设置显示开路，输出控制也同样一定是显示开路，蜂鸣器会一直不响。

软件设置闭路输出，则默认输出方式设置显示闭路，输出控制也同样一定是显示闭路，蜂鸣器会一直响。

软件设置读取默认输出方式，则执行显示当前设备的输出方式，以及当前设备的输出控制状态，注意，此输出方式不一定与输出状态相同。

注意：断电保存的是输入方式以及输出方式，不保存设备断电之前的输出状态。

### 1路有线无线翻译器 Type--B9
[主type=B9 端口1 epType=A1（输入） 端口2 epType=A2（输出）]

二路输出转换器，设备类型DeviceType=B9。

1）返回数据协议

（十六进制）

010K:端口1数据，01表示设置信号输入标识;0K表示输入方式（00为闭路输入,01为开路输入）;

020K:端口1数据，02表示查询信号输入标识;0K表示输入方式（00为闭路输入,01为开路输入）;

030MTT:端口2数据，03表示设置报警数据

0M表示告警输出状态，00开路 01闭路 03开路延时 04闭路延时

TT表示时间参数，当M为0、1时，TT为00，表示状态一直保持。当M为3、4时，TT为01~99，表示有效操作时间;

040N:端口1数据，04表示报警状态标识;0N表示报警状态（00为正常,01为报警）;

050K:端口2数据，表示设置默认输出方式，0K表示输出标志，00开路，01闭路

060K:端口2数据，表示读取默认输出方式，0K表示输出标志，00开路，01闭路

2）发送数据协议

（控制）端口1控制：1K，1表示设置信号输入方式;K表示状态值（0为闭路输入,1为开路输入）

端口1控制：2，表示查询信号输入方式

端口2控制：3MTT，3表示设置报警输出

M表示输出标志，0开路 1闭路 2不改变状态 3开路延时 4闭路延时

TT表示时间参数，M为0或者1时，TT为00（表示状态一直保持），M为3或者4时，TT为01~99（表示有效操作时间）

端口2控制：5K，设置默认输出方式;K表示输出标志，0开路 1闭路

端口2控制：6，读取默认输出方式

（设置）

0：撤防，1布防，

### Mini网关 （Mini网关虚拟设备） Type--D8
Mini网关（Mini网关虚拟设备），设备类型DeviceType=D8。

1）返回数据协议

1xxyy:1表示颜色模式;xx表示颜色;yy表示模式

3aabb:调用声光提醒。当用户调用3或者a时上报

2）发送数据协议

1xxyy:1表示颜色模式;xx表示颜色;yy表示模式

颜色种类：

01：烈焰红 02：翡翠绿 03：芒果黄 04：静谥蓝 05：浪漫紫 06：科幻青 07：日光白

模式：

00：OFF;  01:常亮;  02:流水;  03:快闪;  04:慢闪

3aabb:调用声光提醒，aa为声音模式，10进制数（00为不播放声音，01为叮咚，02为叮铃,03为清脆，04为长音, 05为波动, 06为布谷, 07为嘀嘀, 08为激烈, 09为急促, 10为尖利, 11为警车）；bb为声音大小，10进制数（00没有声音，99为最大音量）；

a:查询灯的当前状态

### 车辆检测器 （模拟，有GPS和车载检测组成，type事先定义好） Type--b0
车辆检测器，设备类型DeviceType=b0。

1）返回数据协议

（并非正真的DS数据，而是通过串口直接上报的）

GPS数据:（详见<长天GPS数据格式3337>）

1:$GPGGA,063754.086,,,,,0,0,,,M,,M,,*45（未成功定位）

2:$GPGGA,064042.000,2238.7686,N,11405.1930,E,1,5,1.38,134.2,M,-2.1,M,,*43（已成功定位）

车辆数据：（详见<车载网关OBD直通协议>）

1:车辆实施数据

$BASE DR DAT$

VBAT:13.5;RPM:951;SPD:0;TP:8.20;LOD:22.35;

ECT:60;FLI:87.50;MPH:1.33;

（2015-7-2，以下客户端暂不实现）

2:驾驶习惯数据

$OBD-DR$MAXRPM:1044;MINRPM:1036

;MAXSPEED:229;AVGSPEED:229;MINSPEED:229;AVGSPEED2:229;

MILE-T:22.9KM;MILE:405.6KM;FUEL-T:5.53L;FUEL:47.04L;

ACCEL:16; BRAKETIMES:12

2）发送数据协议

GPS命令：（无）

车辆数据命令：

1.AT INL，初始化命令（网关自动发送）

2.AT BDAT，车辆实时数据

（2015-7-2，以下客户端暂不实现）

3.AT DRON，开始上报驾驶习惯数据，六分钟一次

4.AT DROFF，停止上报驾驶习惯数据

5.AT DTC，获取车辆故障码

6.AT FCDTC，强行清除汽车OBD 的故障码

7.AT ADTC，分析故障码

8.AT INFO，车辆信息

### 一键开关 Type--f0
[主type=f0 端口1 epType=f0（开关） 端口2 epType=30（场景）（31被中继器占用）]

车辆检测器，设备类型DeviceType=f0。

1）返回数据协议

XX：XX为01表示开，为00表示关（EP_ONE）

2）发送数据协议

X:X为1表示开，X为0表示关（EP_ONE）

（EP_TWO是绑定的场景ID，用cmd=51和cmd=52来获取和设置）

### 一键开关 Type--O8
一键开关,设备类型DeviceType=O8。

企业合作设备，英吉尼
1）返回数据协议

aa：控制上报 aa分别表示每个键的状态，00关，01开；

AAaa:AA表示状态上报，aa分别表示每个键的状态，00关，01开；

2）发送数据协议

a#表示开关（1为开、0为关）

1p#:查询状态

### 二键开关 Type--O9
二键开关,设备类型DeviceType=O9。

企业合作设备，英吉尼
1）返回数据协议

aabb：控制上报 aa，bb分别表示每个键的状态，00关，01开；

AAaabb:AA表示状态上报，aa bb 分别表示每个键的状态，00关，01开；

2）发送数据协议

a#表示开关（1为开、0为关）

1p#:查询状态

### 三键开关 Type--OA
三键开关,设备类型DeviceType=OA。

企业合作设备，英吉尼
1）返回数据协议

aabb：控制上报 aa，bb分别表示每个键的状态，00关，01开；

AAaabb:AA表示状态上报，aa bb 分别表示每个键的状态，00关，01开；

2）发送数据协议

a#表示开关（1为开、0为关）

1p#:查询状态

### 四键开关 Type--OB
四键开关,设备类型DeviceType=OB。

企业合作设备，英吉尼
1）返回数据协议

AAaabbccdd:AA表示状态上报，aa bb cc dd分别表示每个键的状态，00关，01开；

aabbccdd:表示控制上报，aa bb cc dd分别表示每个键的状态，00关，01开；

2）发送数据协议

1p#:查询状态

aaaa#:控制命令，每个键对应一个a，a表示开关（1为开、0为关）
